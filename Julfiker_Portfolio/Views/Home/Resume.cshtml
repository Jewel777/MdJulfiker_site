@{
    ViewData["Title"] = "Resume";
    var pdfPath = Url.Content("~/files/Md_Julfiker_Ali_Jewel_Resume.pdf");
}

<div class="container mt-5 mb-5">
    <h2 class="text-center fw-bold mb-4 text-warning border-bottom pb-2">Resume</h2>

    <!-- ===================== CV SUMMARY ===================== -->
    <section aria-label="CV Summary" class="mb-4">
        <div class="row g-3">
            <!-- Education -->
            <div class="col-12 col-lg-4">
                <div class="summary-card h-100">
                    <div class="d-flex align-items-center mb-2">
                        <i class="bi bi-mortarboard-fill me-2 fs-4 text-warning"></i>
                        <h5 class="mb-0 text-light">Education</h5>
                    </div>
                    <ul class="mb-0 text-light-75">
                        <li><strong>MS, Computer Science</strong> — West Virginia State University, Dec 2024</li>
                        <li><strong>BS, CSE</strong> — Daffodil International University</li>
                        <li>Academic Exchange — SIAS International University (China)</li>
                    </ul>
                </div>
            </div>

            <!-- Experience -->
            <div class="col-12 col-lg-4">
                <div class="summary-card h-100">
                    <div class="d-flex align-items-center mb-2">
                        <i class="bi bi-briefcase-fill me-2 fs-4 text-warning"></i>
                        <h5 class="mb-0 text-light">Experience</h5>
                    </div>
                    <ul class="mb-0 text-light-75">
                        <li><strong>Software Programmer</strong> — WV DHHR (May 2024–Present)</li>
                        <li><strong>Graduate Assistant (RA &amp; TA)</strong> — WVSU (Jan 2023–Dec 2024)</li>
                        <li><strong>IT Analyst Intern</strong> — WV Dept. of Transportation (May–Aug 2023)</li>
                    </ul>
                </div>
            </div>

            <!-- Skills -->
            <div class="col-12 col-lg-4">
                <div class="summary-card h-100">
                    <div class="d-flex align-items-center mb-2">
                        <i class="bi bi-cpu-fill me-2 fs-4 text-warning"></i>
                        <h5 class="mb-0 text-light">Skills</h5>
                    </div>
                    <div class="text-light-75">
                        <div class="mb-1"><strong>.NET &amp; DB:</strong> C#, ASP.NET Core, EF, SQL Server</div>
                        <div class="mb-1"><strong>Python/ML:</strong> TensorFlow, PyTorch, Optuna, SHAP</div>
                        <div class="mb-0"><strong>Security:</strong> IDS/IPS, Zero Trust, OAuth/OIDC, OWASP</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick tags -->
        <div class="mt-3 d-flex flex-wrap gap-2">
            <span class="tag">C#/.NET</span>
            <span class="tag">SQL Server</span>
            <span class="tag">Python</span>
            <span class="tag">ML/DL</span>
            <span class="tag">Cybersecurity</span>
            <span class="tag">Cloud-ready</span>
        </div>
    </section>

    <!-- ===================== CONTROLS ===================== -->
    <div class="d-flex flex-wrap gap-3 align-items-center mb-3">
        <a class="btn btn-warning fw-semibold rounded-pill"
           href="@pdfPath" target="_blank" rel="noopener">
            Open in new tab
        </a>

        <button id="previewBtn" type="button"
                class="btn btn-outline-light fw-semibold rounded-pill">
            Preview here
        </button>

        <a id="downloadBtn" class="btn btn-secondary fw-semibold rounded-pill disabled"
           href="@pdfPath" download>
            Download PDF
        </a>
    </div>

    <!-- ===================== INLINE VIEWER ===================== -->
    <div id="pdfShell" class="pdf-shell d-none">
        <div class="pdf-loading" id="pdfLoading">
            <div class="spinner-border" role="status" aria-label="Loading PDF..."></div>
            <small class="text-muted ms-2">Loading preview…</small>
        </div>

        <iframe id="resumeFrame"
                title="Resume PDF Preview"
                loading="lazy"
                referrerpolicy="no-referrer"
                sandbox="allow-same-origin allow-scripts"
                class="pdf-frame"></iframe>

        <div id="pdfFallback" class="alert alert-warning d-none mt-3" role="alert">
            Couldn’t show the inline preview. You can still
            <a class="alert-link" href="@pdfPath" target="_blank" rel="noopener">open the PDF in a new tab</a>
            or use the Download button.
        </div>
    </div>
</div>

<style>
/* ====== Summary Cards ====== */
.summary-card{
    background: rgba(34,40,49,.85);
    border: 1px solid rgba(255,255,255,.08);
    border-radius: 16px;
    padding: 16px 18px;
    box-shadow: 0 8px 24px rgba(0,0,0,.28);
    backdrop-filter: blur(6px);
}
.text-light-75{ color: rgba(255,255,255,.82); }
.tag{
    background: linear-gradient(45deg,#ffc107,#ff9800);
    color:#111;
    border-radius:999px;
    padding:.25rem .75rem;
    font-weight:700;
    font-size:.85rem;
    box-shadow:0 4px 10px rgba(255,152,0,.25);
}

/* ====== PDF Viewer ====== */
.pdf-shell {
    position: relative;
    background: #0b0f14;
    border-radius: 16px;
    box-shadow: 0 8px 24px rgba(0,0,0,.35);
    overflow: hidden;
    height: clamp(420px, 70vh, 900px);
}
.pdf-frame {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    border: 0;
    background: #0b0f14;
}
.pdf-loading {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    pointer-events: none;
    z-index: 2;
}
.d-none { display: none !important; }
</style>

<script>
(function () {
  const previewBtn  = document.getElementById('previewBtn');
  const shell       = document.getElementById('pdfShell');
  const frame       = document.getElementById('resumeFrame');
  const loadingEl   = document.getElementById('pdfLoading');
  const fallbackEl  = document.getElementById('pdfFallback');
  const downloadBtn = document.getElementById('downloadBtn');

  const PDF_URL = '@pdfPath' + '#view=FitH';

  async function fileExists(url) {
    try {
      const res = await fetch(url.split('#')[0], { method: 'HEAD', cache: 'no-store' });
      return res.ok;
    } catch (_) { return false; }
  }

  function showShell() {
    shell.classList.remove('d-none');
    loadingEl.classList.remove('d-none');
    fallbackEl.classList.add('d-none');
  }

  function enableDownload() {
    downloadBtn.classList.remove('disabled');
  }

  async function loadPreview() {
    if (frame.getAttribute('src')) return;
    showShell();

    if (await fileExists(PDF_URL)) {
      const watchdog = setTimeout(() => {
        loadingEl.classList.add('d-none');
        fallbackEl.classList.remove('d-none');
      }, 4000);

      frame.addEventListener('load', () => {
        clearTimeout(watchdog);
        loadingEl.classList.add('d-none');
        enableDownload();
      }, { once: true });

      frame.addEventListener('error', () => {
        clearTimeout(watchdog);
        loadingEl.classList.add('d-none');
        fallbackEl.classList.remove('d-none');
      }, { once: true });

      frame.setAttribute('src', PDF_URL);
    } else {
      loadingEl.classList.add('d-none');
      fallbackEl.classList.remove('d-none');
    }
  }

  if (previewBtn) previewBtn.addEventListener('click', loadPreview);
  fileExists(PDF_URL).then(ok => { if (ok) enableDownload(); });
})();
</script>
