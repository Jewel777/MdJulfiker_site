@{
    ViewData["Title"] = "Resume";
}

<div class="container mt-5 mb-5">
    <h2 class="text-center fw-bold mb-4 text-warning border-bottom pb-2">My Resume</h2>

    <!-- Preview + Download Buttons -->
    <div class="text-center mb-4 d-flex flex-wrap gap-3 justify-content-center">
        <!-- Preview (opens Bootstrap modal) -->
        <button
            id="openPreviewBtn"
            class="btn btn-lg btn-outline-warning fw-bold shadow px-4 py-3 rounded-pill"
            data-bs-toggle="modal"
            data-bs-target="#resumeModal"
            aria-label="Preview Resume in a modal">
            üëÅÔ∏è Preview Resume
        </button>

        <!-- Download (forces save) -->
        <a href="@Url.Content("~/files/Md_Julfiker_Ali_Jewel_Resume.pdf")"
           class="btn btn-lg btn-gradient-warning text-dark fw-bold shadow px-4 py-3 rounded-pill animated-button"
           target="_blank" download
           aria-label="Download Resume as PDF">
            üìÑ Download Resume
        </a>
    </div>

    <!-- ====== Stats / Counters Section (optional) ====== -->
    <section class="container text-center my-5" aria-label="Career Highlights">
        <div class="row g-4 justify-content-center">
            <div class="col-6 col-md-4">
                <div class="counter-card">
                    <h2 class="counter text-warning mb-1" data-target="5">0</h2>
                    <p class="mb-0 text-light-50">Years of Experience</p>
                </div>
            </div>
            <div class="col-6 col-md-4">
                <div class="counter-card">
                    <h2 class="counter text-warning mb-1" data-target="15">0</h2>
                    <p class="mb-0 text-light-50">Projects Completed</p>
                </div>
            </div>
            <div class="col-6 col-md-4">
                <div class="counter-card">
                    <h2 class="counter text-warning mb-1" data-target="6">0</h2>
                    <p class="mb-0 text-light-50">Research Publications</p>
                </div>
            </div>
        </div>
    </section>

    <div class="row justify-content-center">
        <div class="col-md-10">

            <!-- Education Section -->
            <div class="exp-card mb-4">
                <h5 class="fw-semibold text-light">üéì Education</h5>
                <ul class="text-light">
                    <li>M.S. in Computer Science, West Virginia State University (Dec 2024)</li>
                    <li>B.Sc. in Computer Science and Engineering, Daffodil International University</li>
                </ul>
            </div>

            <!-- Experience Section -->
            <div class="exp-card mb-4">
                <h5 class="fw-semibold text-light">üíº Experience</h5>
                <ul class="text-light">
                    <li>Software Programmer, WV DHHR ‚Äì May 2024 to Present</li>
                    <li>Graduate Research & Teaching Assistant, WVSU ‚Äì Jan 2023 to Dec 2024</li>
                    <li>Information System Analyst Intern, WV Department of Transportation ‚Äì May 2023 to Aug 2023</li>
                </ul>
            </div>

            <!-- Skills Section -->
            <div class="exp-card mb-4">
                <h5 class="fw-semibold text-light">üõ†Ô∏è Skills</h5>
                <p class="text-light mb-0">
                    C#, .NET, Java, Python, HTML/CSS/JS, SQL, PyTorch, TensorFlow, VBA, COBOL, JCL
                </p>
            </div>

        </div>
    </div>
</div>

<!-- ====== Modal for PDF Preview ====== -->
<div class="modal fade" id="resumeModal" tabindex="-1" aria-labelledby="resumeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-fullscreen-lg-down modal-xl">
    <div class="modal-content bg-dark text-light border-0">
      <div class="modal-header border-0">
        <h5 class="modal-title text-warning" id="resumeModalLabel">Resume Preview</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <!-- Modal body with PDF + fallback -->
      <div class="modal-body p-0">
        <div class="pdf-responsive">
          <!-- Safer embed; prevents preload, keeps viewer fast & scrollable -->
          <iframe
            id="resumeFrame"
            title="Resume PDF Preview"
            loading="lazy"
            referrerpolicy="no-referrer"
            sandbox="allow-same-origin allow-scripts">
          </iframe>
        </div>

        <!-- Fallback shown only if PDF can't be embedded -->
        <div id="resumeFallback" class="p-4 d-none">
          <div class="alert alert-warning mb-2">
            Your browser can‚Äôt preview PDFs here.
          </div>
          <a class="btn btn-warning"
             href="@Url.Content("~/files/Md_Julfiker_Ali_Jewel_Resume.pdf")"
             target="_blank" rel="noopener">
            Open in new tab
          </a>
        </div>
      </div>

      <div class="modal-footer border-0 d-flex justify-content-between">
        <small class="text-muted">Tip: Use your browser‚Äôs print or download controls in the preview.</small>
        <a href="@Url.Content("~/files/Md_Julfiker_Ali_Jewel_Resume.pdf")"
           class="btn btn-gradient-warning text-dark fw-bold rounded-pill"
           target="_blank" download>
            üìÑ Download PDF
        </a>
      </div>
    </div>
  </div>
</div>

<!-- Styles -->
<style>
    :root {
        --card-bg: #222831;
        --accent: #ff6a00;
        --accent-soft: rgba(255, 106, 0, 0.25);
        --accent-strong: rgba(255, 106, 0, 0.5);
    }

    body { background-color: #121212; }

    /* Cards */
    .exp-card {
        background-color: var(--card-bg);
        padding: 25px;
        border-radius: 16px;
        box-shadow: 0 6px 18px var(--accent-soft);
        transition: transform 0.4s ease, box-shadow 0.4s ease;
        transform-style: preserve-3d;
    }
    .exp-card:hover {
        transform: translateZ(0) rotateY(4deg) scale(1.03);
        box-shadow: 0 14px 28px var(--accent-strong);
        z-index: 10;
    }

    /* List spacing */
    ul { padding-left: 1.5rem; }
    ul li { margin-bottom: 0.5rem; }

    /* Buttons */
    .btn-gradient-warning {
        background: linear-gradient(45deg, #ffc107, #ff9800);
        border: none;
        color: #000;
    }
    .btn-gradient-warning:hover,
    .btn-gradient-warning:focus-visible {
        background: linear-gradient(45deg, #ff9800, #ffc107);
        color: #000;
        transform: scale(1.05);
        box-shadow: 0 8px 16px rgba(255, 152, 0, 0.4);
    }
    .animated-button { transition: all 0.4s ease-in-out; }

    /* ===== Counters ===== */
    .counter-card {
        background: #1a1f27;
        border-radius: 16px;
        padding: 22px 16px;
        box-shadow: 0 6px 18px rgba(0,0,0,0.35);
        transition: transform .3s ease, box-shadow .3s ease;
    }
    .counter-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 28px rgba(0,0,0,0.45);
    }
    .counter {
        font-size: 3rem;
        font-weight: 800;
        line-height: 1;
        letter-spacing: .5px;
    }
    .text-light-50 { color: rgba(255,255,255,0.75); }

    /* Modal PDF */
    .pdf-responsive {
        position: relative;
        width: 100%;
        height: calc(100vh - 200px); /* tall on desktop */
        background: #0b0f14;
    }
    /* IMPORTANT: escape Razor here */
    @@media (max-width: 991.98px) {
        .pdf-responsive { height: 70vh; } /* shorter on mobile/tablet */
    }
    #resumeFrame {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        border: 0;
        background: #111; /* avoid white flash while loading */
    }

    /* Make modal body scroll smooth on iOS Safari */
    .modal .modal-body { -webkit-overflow-scrolling: touch; }

    /* Focus styles for a11y */
    .btn:focus-visible, a:focus-visible, button:focus-visible {
        outline: 2px solid #00e1ff;
        outline-offset: 2px;
        border-radius: 12px;
    }
</style>

<!-- Scripts: Lazy-load the PDF into the modal only when opened, with graceful fallback -->
<script>
document.addEventListener('DOMContentLoaded', function () {
  var modalEl = document.getElementById('resumeModal');
  var frame = document.getElementById('resumeFrame');
  var fallback = document.getElementById('resumeFallback');
  var pdfUrl = '@Url.Content("~/files/Md_Julfiker_Ali_Jewel_Resume.pdf")#view=FitH';

  function showFallback() {
    if (fallback) fallback.classList.remove('d-none');
  }

  modalEl.addEventListener('shown.bs.modal', function () {
    // Lazy set src once
    if (!frame.getAttribute('src')) {
      // Show fallback if embed fails or is too slow
      var watchdog = setTimeout(showFallback, 3500);

      frame.addEventListener('load', function () {
        clearTimeout(watchdog);
      }, { once: true });

      frame.addEventListener('error', function () {
        clearTimeout(watchdog);
        showFallback();
      }, { once: true });

      frame.setAttribute('src', pdfUrl);
    }
  });

  // Clear src when closing to free memory & reset fallback
  modalEl.addEventListener('hidden.bs.modal', function () {
    frame.setAttribute('src', '');
    if (fallback) fallback.classList.add('d-none');
  });

  // Counter animation
  const counters = document.querySelectorAll('.counter');
  function animate(el) {
    const target = Number(el.dataset.target || 0);
    const duration = 1200;
    const startTime = performance.now();
    function step(now) {
      const progress = Math.min((now - startTime) / duration, 1);
      el.textContent = Math.floor(target * progress).toLocaleString();
      if (progress < 1) requestAnimationFrame(step);
    }
    requestAnimationFrame(step);
  }
  if ('IntersectionObserver' in window) {
    const io = new IntersectionObserver((entries, obs) => {
      entries.forEach(entry => { if (entry.isIntersecting) { animate(entry.target); obs.unobserve(entry.target); } });
    }, { threshold: 0.6 });
    counters.forEach(c => io.observe(c));
  } else {
    counters.forEach(animate);
  }
});
</script>
